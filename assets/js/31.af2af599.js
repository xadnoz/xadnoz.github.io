(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{395:function(e,t,s){"use strict";s.r(t);var r=s(42),a=Object(r.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"bisq-pricenode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bisq-pricenode"}},[e._v("#")]),e._v(" bisq-pricenode")]),e._v(" "),s("h2",{attrs:{id:"overview"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[e._v("#")]),e._v(" Overview")]),e._v(" "),s("p",[e._v("The Bisq pricenode is a simple HTTP service that fetches, transforms and relays data from third-party price providers to Bisq exchange clients on request. Available prices include:")]),e._v(" "),s("ul",[s("li",[e._v("Bitcoin exchange rates, available at "),s("code",[e._v("/getAllMarketPrices")]),e._v(", and")]),e._v(" "),s("li",[e._v("Bitcoin mining fee rates, available at "),s("code",[e._v("/getFees")])])]),e._v(" "),s("p",[e._v("Pricenodes are deployed in production as Tor hidden services. This is not because the location of these nodes needs to be kept secret, but rather so that Bisq exchange clients do not need to exit the Tor network in order to get price data.")]),e._v(" "),s("p",[e._v("Anyone can run a pricenode, but it must be "),s("em",[e._v("discoverable")]),e._v(" in order for it to do any good. For exchange clients to discover your pricenode, its .onion address must be hard-coded in the Bisq exchange client's "),s("code",[e._v("ProvidersRepository")]),e._v(" class. Alternatively, users can point explicitly to given pricenode (or set of pricenodes) with the exchange client's "),s("code",[e._v("--providers")]),e._v(" command line option.")]),e._v(" "),s("p",[e._v("Pricenodes can be deployed anywhere Java and Tor binaries can be run. Instructions below cover deployment on localhost, and instructions "),s("RouterLink",{attrs:{to:"/bisq/pricenode/README-HEROKU.html"}},[e._v("how to deploy on Heroku")]),e._v(" are also available.")],1),e._v(" "),s("p",[e._v("Pricenodes should be cheap to run with regard to both time and money. The application itself is non-resource intensive and can be run on the low-end of most providers' paid tiers.")]),e._v(" "),s("p",[e._v("A "),s("a",{attrs:{href:"https://github.com/bisq-network/roles/issues/5",target:"_blank",rel:"noopener noreferrer"}},[e._v("pricenode operator"),s("OutboundLink")],1),e._v('\'s main responsibilities are to ensure their node(s) are available and up-to-date. Releases are currently source-only, with the assumption that most operators will favor Git-based "push to deploy" workflows. To stay up to date with releases, operators can '),s("a",{attrs:{href:"https://github.com/bisq-network/pricenode/releases.atom",target:"_blank",rel:"noopener noreferrer"}},[e._v("subscribe to this repository's releases.atom feed"),s("OutboundLink")],1),e._v(" and/or get notifications in the "),s("code",[e._v("#pricenode")]),e._v(" Slack channel.")]),e._v(" "),s("p",[e._v("Operating a production pricenode is a valuable service to the Bisq network, and operators should issue BSQ compensation requests accordingly.")]),e._v(" "),s("h2",{attrs:{id:"prerequisites-for-running-a-pricenode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites-for-running-a-pricenode"}},[e._v("#")]),e._v(" Prerequisites for running a pricenode")]),e._v(" "),s("p",[e._v("To run a pricenode, you will need:")]),e._v(" "),s("ul",[s("li",[e._v("JDK 8 if you want to build and run a node locally.")]),e._v(" "),s("li",[e._v("The "),s("code",[e._v("tor")]),e._v(" binary (e.g. "),s("code",[e._v("brew install tor")]),e._v(") if you want to run a hidden service locally.")])]),e._v(" "),s("h2",{attrs:{id:"how-to-deploy-for-production"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#how-to-deploy-for-production"}},[e._v("#")]),e._v(" How to deploy for production")]),e._v(" "),s("h3",{attrs:{id:"install"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#install"}},[e._v("#")]),e._v(" Install")]),e._v(" "),s("p",[e._v("Run the one-command installer:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -s https://raw.githubusercontent.com/bisq-network/bisq/master/pricenode/install_pricenode_debian.sh "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("bash")]),e._v("\n")])])]),s("p",[e._v("At the end of the installer script, it should print your Tor onion hostname.")]),e._v(" "),s("h3",{attrs:{id:"test"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#test"}},[e._v("#")]),e._v(" Test")]),e._v(" "),s("p",[e._v("To manually test endpoints, run each of the following:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" http://localhost:8080/getAllMarketPrices\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" http://localhost:8080/getFees\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" http://localhost:8080/getParams\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" http://localhost:8080/getVersion\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" http://localhost:8080/info\n")])])]),s("h3",{attrs:{id:"monitoring"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#monitoring"}},[e._v("#")]),e._v(" Monitoring")]),e._v(" "),s("p",[e._v("If you run a main pricenode, you also are obliged to activate the monitoring feed by running")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("bash")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -s https://raw.githubusercontent.com/bisq-network/bisq/master/monitor/install_collectd_debian.sh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),s("p",[e._v("Follow the instruction given by the script and report your certificate to the "),s("a",{attrs:{href:"https://github.com/orgs/bisq-network/teams/monitoring-operators",target:"_blank",rel:"noopener noreferrer"}},[e._v("@bisq-network/monitoring"),s("OutboundLink")],1),e._v(" team or via the "),s("a",{attrs:{href:"https://keybase.io/team/bisq",target:"_blank",rel:"noopener noreferrer"}},[e._v("Keybase"),s("OutboundLink")],1),e._v(" "),s("code",[e._v("#monitoring")]),e._v(" channel!")]),e._v(" "),s("p",[e._v("Furthermore, you are obliged to provide network size data to the monitor by running")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -s https://raw.githubusercontent.com/bisq-network/bisq/master/pricenode/install_networksize_debian.sh "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("bash")]),e._v("\n")])])]),s("h3",{attrs:{id:"updating"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#updating"}},[e._v("#")]),e._v(" Updating")]),e._v(" "),s("p",[e._v("Update your bisq code in /bisq/bisq with "),s("code",[e._v("git pull")])]),e._v(" "),s("p",[e._v("Then build an updated pricenode:\n"),s("code",[e._v("./gradlew :pricenode:installDist -x test")])]),e._v(" "),s("h2",{attrs:{id:"how-to-deploy-elsewhere"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#how-to-deploy-elsewhere"}},[e._v("#")]),e._v(" How to deploy elsewhere")]),e._v(" "),s("ul",[s("li",[s("RouterLink",{attrs:{to:"/bisq/pricenode/README-HEROKU.html"}},[e._v("README-HEROKU.md")])],1),e._v(" "),s("li",[s("RouterLink",{attrs:{to:"/bisq/pricenode/docker/"}},[e._v("docker/README.md")])],1)]),e._v(" "),s("h2",{attrs:{id:"bitcoin-mining-fee-estimates"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bitcoin-mining-fee-estimates"}},[e._v("#")]),e._v(" Bitcoin mining fee estimates")]),e._v(" "),s("p",[e._v("The pricenode exposes a service API to Bisq clients under "),s("code",[e._v("/getFees")]),e._v(".")]),e._v(" "),s("p",[e._v("This API returns a mining fee rate estimate, representing an average of several mining fee rate values retrieved from different "),s("code",[e._v("mempool.space")]),e._v(" instances.")]),e._v(" "),s("p",[e._v("To configure which "),s("code",[e._v("mempool.space")]),e._v(" instances are queried to calculate this average, see the relevant section in the file "),s("code",[e._v("application.properties")]),e._v(".")])])}),[],!1,null,null,null);t.default=a.exports}}]);