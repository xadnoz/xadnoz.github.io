(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{385:function(e,t,s){"use strict";s.r(t);var a=s(42),n=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"automated-setup-of-regtest-dao-for-linux"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#automated-setup-of-regtest-dao-for-linux"}},[e._v("#")]),e._v(" Automated setup of regtest DAO - for Linux")]),e._v(" "),s("p",[e._v("The goal of these helper scripts is to set up a bisq DAO from scratch. The scripts run "),s("code",[e._v("bitcoind")]),e._v(" in regtest mode for you and a "),s("code",[e._v("seed node")]),e._v(", "),s("code",[e._v("alice")]),e._v(" and "),s("code",[e._v("bob")]),e._v(" instances.")]),e._v(" "),s("p",[e._v("We assume the user is in the "),s("code",[e._v("autosetup-regtest-dao")]),e._v(" directory. It is ok to move the directory, but please move it as a whole. Also "),s("code",[e._v("bitcoin-qt")]),e._v(", "),s("code",[e._v("bitcoin-cli")]),e._v(", "),s("code",[e._v("bitcoin-tx")]),e._v(", "),s("code",[e._v("jq")]),e._v(" and "),s("code",[e._v("bc")]),e._v(" has to be installed on the system. Do not change the shipped "),s("code",[e._v("bitcoin.conf")]),e._v(" file as it will break things.")]),e._v(" "),s("h2",{attrs:{id:"steps-to-spin-up-a-fresh-dao-we-assume-the-user-is-in-the-autosetup-regtest-dao-directory"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#steps-to-spin-up-a-fresh-dao-we-assume-the-user-is-in-the-autosetup-regtest-dao-directory"}},[e._v("#")]),e._v(" Steps to spin up a fresh DAO (we assume the user is in the autosetup-regtest-dao directory):")]),e._v(" "),s("ol",[s("li",[e._v("Set up "),s("code",[e._v("bitcoin-qt")]),e._v(" to run in the "),s("code",[e._v("autosetup-regtest-dao")]),e._v(" directory, it detects when the "),s("code",[e._v("bitcoin-qt")]),e._v(" instance comes up and once it is ready the script queries the number of blocks. If there are less then 101 blocks (fresh start) the script generates 101 blocks for you so you have an available input that will be later used for the genesis tx creation.")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("./start_bitcoind.sh\n")])])]),s("p",[e._v("Example output (note the below errors are normal and can be ignored):")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('user@host:~/bin/KanoczTomas/bisq/docs/autosetup-regtest-dao$ ./start_bitcoind.sh\nerror: Could not connect to the server 127.0.0.1:18443\nMake sure the bitcoind server is running and that you are connecting to the correct RPC port.\nerror code: -28\nerror message:\nLoading wallet...\n./generate_101_blocks.sh: found less blocks then 101, generating ...\n./blocknotify: line 2: echo: write error: Broken pipe\n./blocknotify: line 2: echo: write error: Broken pipe\n./blocknotify: line 2: echo: write error: Broken pipe\n./blocknotify: line 2: echo: write error: Broken pipe\n./blocknotify: line 2: echo: write error: Broken pipe\n./blocknotify: line 2: echo: write error: Broken pipe\n./blocknotify: line 2: echo: write error: Broken pipe\n./blocknotify: line 2: echo: write error: Broken pipe\n./blocknotify: line 2: echo: write error: Broken pipe\n./blocknotify: line 2: echo: write error: Broken pipe\n[\n  "24e04970e3b55fe45efde314cc959a7baeef379d74d322bc132b723235f1e8ca",\n  <truncated output for compactness>\n  "2d4aaa455c681b604a683437c657e23b19af0b614f5f822c4c7aecee865b5f5f"\n]\n./generate_101_blocks.sh: done, exiting\n')])])]),s("ol",{attrs:{start:"2"}},[s("li",[e._v("Open a new terminal (preferably a new tab), go to the "),s("code",[e._v("bisq")]),e._v(" folder and start the "),s("code",[e._v("create_genesis.sh")]),e._v(" script. The script tests for a running bitcoind node in regtest, so make sure step 1 was successful.")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("cd bisq\n./create_genesis.sh\n")])])]),s("p",[e._v("example output:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("user@host:~/bin/KanoczTomas/bisq/docs/autosetup-regtest-dao/bisq$ ./create_genesis.sh\ntesting if bitcoind is running: bitcoind is running, all is ok!\nPlease provide Alice's BSQ Address\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[e._v("We need the BSQ address of "),s("code",[e._v("Alice")]),e._v(". Go to the "),s("code",[e._v("bisq")]),e._v(" directory and start the "),s("code",[e._v("Alice")]),e._v(" instance. Wait until the instance starts up then go to "),s("code",[e._v("DAO -> Receive")]),e._v(" and copy the BSQ address. Note the address starts with a "),s("code",[e._v("B")]),e._v(". Open a new terminal and enter the commands below to start "),s("code",[e._v("Alice")]),e._v(". Then wait for the gui to start and paste the BSQ address to "),s("code",[e._v("create_genesis.sh")]),e._v(" which is still running from step 2.")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("cd bisq\n./alice\n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[e._v("Enter the amount of BTC in the "),s("code",[e._v("create_genesis.sh")]),e._v(" script you want "),s("code",[e._v("Alice")]),e._v(" to receive as BSQ.\nExample output:")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("user@host:~/bin/KanoczTomas/bisq/docs/autosetup-regtest-dao/bisq$ ./create_genesis.sh\ntesting if bitcoind is running: bitcoind is running, all is ok!\nPlease provide Alice's BSQ Address\nBn2iUHwJQTreQaoajKwnT6h7pYF9nCWULJA\nHow much BTC to turn to BSQ for Alice? (sum must be 2.5BTC)\n1\nAlice will receive 1000000.00 BSQ to Bn2iUHwJQTreQaoajKwnT6h7pYF9nCWULJA\n")])])]),s("ol",{attrs:{start:"5"}},[s("li",[e._v("We need the BSQ address of "),s("code",[e._v("Bob")]),e._v(". Go to the "),s("code",[e._v("bisq")]),e._v(" directory and start the "),s("code",[e._v("Bob")]),e._v(" instance. Wait until the instance starts up then go to "),s("code",[e._v("DAO -> Receive")]),e._v(" and copy the BSQ address. Note the address starts with a "),s("code",[e._v("B")]),e._v(". Open a new terminal and enter the commands below to start "),s("code",[e._v("Bob")]),e._v(". Then wait for the gui to start and paste the BSQ address to "),s("code",[e._v("create_genesis.sh")]),e._v(" which is still running from step 2.")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("cd bisq\n./bob\n")])])]),s("ol",{attrs:{start:"6"}},[s("li",[e._v("Enter the amount of BTC in the "),s("code",[e._v("create_genesis.sh")]),e._v(" script you want "),s("code",[e._v("Bob")]),e._v(" to receive as BSQ.\nExample output:")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('tk@workbook:~/bin/KanoczTomas/bisq/docs/autosetup-regtest-dao/bisq$ ./create_genesis.sh\ntesting if bitcoind is running: bitcoind is running, all is ok!\nPlease provide Alice\'s BSQ Address\nBn2iUHwJQTreQaoajKwnT6h7pYF9nCWULJA\nHow much BTC to turn to BSQ for Alice? (sum must be 2.5BTC)\n1\nAlice will receive 1000000.00 BSQ to Bn2iUHwJQTreQaoajKwnT6h7pYF9nCWULJA\nPlease provide Bob\'s BSQ Address\nBmoccyQEENPwxeZUdPAnDejEeTzykD9Kdbo\nHow much BTC to turn to BSQ for Bob? (sum must be 2.5BTC)\n1.5\nBob will receive 1500000.00 BSQ to BmoccyQEENPwxeZUdPAnDejEeTzykD9Kdbo\ngot address 2MwNUS6czZZ8tFeFArujf1AghFZUfcJmgRx\nsending 2.5001 BTC to 2MwNUS6czZZ8tFeFArujf1AghFZUfcJmgRx\ntxid is: d8c9d0caaaa69ad26e3dbe2176cd7fd48a4509b96cd902982fbc9811211cf20e\ncreating genesis tx for you\nThe raw genesis tx is: 020000000001010ef21c211198bc2f9802d96cb909458ad47fcd7621be3d6ed29aa6aacad0c9d80000000017160014d3316afa653bb7ca1f7bfd2395c373c979fd14ddffffffff0200e1f505000000001976a914e8884212730dd91d620b92d2e95245baf776d78b88ac80d1f008000000001976a91458d35f88e65ded63cb22a25ffda6f83a0209822b88ac0247304402204395a123c499f05bdc9b458459d97df1910feb9a43d66b7ca7e28a91c6cf19a702203ddb3fb891442bb76a2a8e267b4fec99c8a40064461556a03a799e787d08334f01210397ff7d1aa76f2fb241b0354332bb1e9be0520e744a8a2a7e5e088a92a7c09dd200000000\nPlease verify if decoded tx looks ok:\n{\n  "txid": "a876c877de410480530f7e8fa7e34034085db4db603d30a5635610fb59e646b2",\n  "hash": "81923b096990db55e44730a4c3af975b1ecd995d8cbfdac939b16081249aa8bc",\n  "version": 2,\n  "size": 251,\n  "vsize": 170,\n  "weight": 677,\n  "locktime": 0,\n  "vin": [\n    {\n      "txid": "d8c9d0caaaa69ad26e3dbe2176cd7fd48a4509b96cd902982fbc9811211cf20e",\n      "vout": 0,\n      "scriptSig": {\n        "asm": "0014d3316afa653bb7ca1f7bfd2395c373c979fd14dd",\n        "hex": "160014d3316afa653bb7ca1f7bfd2395c373c979fd14dd"\n      },\n      "txinwitness": [\n        "304402204395a123c499f05bdc9b458459d97df1910feb9a43d66b7ca7e28a91c6cf19a702203ddb3fb891442bb76a2a8e267b4fec99c8a40064461556a03a799e787d08334f01",\n        "0397ff7d1aa76f2fb241b0354332bb1e9be0520e744a8a2a7e5e088a92a7c09dd2"\n      ],\n      "sequence": 4294967295\n    }\n  ],\n  "vout": [\n    {\n      "value": 1,\n      "n": 0,\n      "scriptPubKey": {\n        "asm": "OP_DUP OP_HASH160 e8884212730dd91d620b92d2e95245baf776d78b OP_EQUALVERIFY OP_CHECKSIG",\n        "hex": "76a914e8884212730dd91d620b92d2e95245baf776d78b88ac",\n        "reqSigs": 1,\n        "type": "pubkeyhash",\n        "addresses": [\n          "n2iUHwJQTreQaoajKwnT6h7pYF9nCWULJA"\n        ]\n      }\n    },\n    {\n      "value": 1.5,\n      "n": 1,\n      "scriptPubKey": {\n        "asm": "OP_DUP OP_HASH160 58d35f88e65ded63cb22a25ffda6f83a0209822b OP_EQUALVERIFY OP_CHECKSIG",\n        "hex": "76a91458d35f88e65ded63cb22a25ffda6f83a0209822b88ac",\n        "reqSigs": 1,\n        "type": "pubkeyhash",\n        "addresses": [\n          "moccyQEENPwxeZUdPAnDejEeTzykD9Kdbo"\n        ]\n      }\n    }\n  ]\n}\nPress enter to broadcast transaction, ctrl+c otherwise\n')])])]),s("ol",{attrs:{start:"7"}},[s("li",[s("p",[e._v("verify if the tx shown as json is ok (the sum of outputs must be 2.5 to be valid). Note the script does not check the sum of the outputs as one needs to create an invalid genesis tx as well to test things. Press "),s("code",[e._v("enter")]),e._v(" if tx looks ok.")])]),e._v(" "),s("li",[s("p",[e._v("Once confirmed the script will broadcast the genesis tx to the regtest blockchain and setup the "),s("code",[e._v("config.sh")]),e._v(" file in the "),s("code",[e._v("bisq")]),e._v(" directory which is used by the "),s("code",[e._v("seed_node")]),e._v(", "),s("code",[e._v("alice")]),e._v(" and "),s("code",[e._v("bob")]),e._v(" scripts. It populates the genesis txid and genesis block height so the instances can be launched accordingly.\nExample output:")])])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("... <output ommited - see step above>\nPress enter to broadcast transaction, ctrl+c otherwise\nGenesis txid is:\na876c877de410480530f7e8fa7e34034085db4db603d30a5635610fb59e646b2\nMining genesis tx for you\ngenesis_block is 39249aab4e42c85e14f59517ec6b45305fdc7d660315c6602aab1a1b7b96cd3b\ngenesis_height is 102\nyour conf file was modified accordingly\ndao setup done\n")])])]),s("ol",{attrs:{start:"9"}},[s("li",[e._v("Start the "),s("code",[e._v("seed")]),e._v(" node in full DAO node using the "),s("code",[e._v("seed_node")]),e._v(" script. Make sure you are in the "),s("code",[e._v("bisq")]),e._v(" directory.")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("cd bisq\n./seed_node\n")])])]),s("ol",{attrs:{start:"10"}},[s("li",[e._v("Restart "),s("code",[e._v("Alice")]),e._v(" and "),s("code",[e._v("Bob")]),e._v(" you should see BSQ visible on the "),s("code",[e._v("DAO")]),e._v(" page. Note the "),s("code",[e._v("seed node")]),e._v(" is a full node and "),s("code",[e._v("alice")]),e._v("/"),s("code",[e._v("bob")]),e._v(" are lite nodes in this setup.")])]),e._v(" "),s("h2",{attrs:{id:"continuing-work-on-the-existing-setup"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#continuing-work-on-the-existing-setup"}},[e._v("#")]),e._v(" Continuing work on the existing setup")]),e._v(" "),s("ol",[s("li",[e._v("Just run "),s("code",[e._v("start_bitcoind.sh")]),e._v(" script and spin up "),s("code",[e._v("seed node")]),e._v(", "),s("code",[e._v("alice")]),e._v(" and "),s("code",[e._v("bob")]),e._v(" with respected scripts.")])]),e._v(" "),s("h2",{attrs:{id:"clearing-the-dao-for-a-fresh-start"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#clearing-the-dao-for-a-fresh-start"}},[e._v("#")]),e._v(" Clearing the DAO - for a fresh start")]),e._v(" "),s("ol",[s("li",[e._v("Run "),s("code",[e._v("clean.sh")]),e._v(". It will clear the bitcoind files and bisq files from "),s("code",[e._v("~/.local/share/")]),e._v(" directory. Make sure your "),s("code",[e._v("bitcoind/bitcoin-qt")]),e._v(" is stopped before running.")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("user@host:~/bin/KanoczTomas/bisq/docs/autosetup-regtest-dao$ ./clean.sh\nDANGER! This will nuke your bitcoin regtest dir and bisq seed, alice and bob regtest dirs as well!\nPress Enter to continue, otherwise ctrl+c\ncleaned bitcoind home and bisq seed, alice, bob instances. The conf file for bisq was reset to dao=false\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);